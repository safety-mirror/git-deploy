#!/usr/bin/env python

import sys
import base64

def validate_pubkey(value):
    if len(value) > 8192 or len(value) < 80:
      raise ValueError("Expected length to be between 80 and 8192 characters")

    value = value.replace("\"", "").replace("'", "").replace("\\\"", "")
    value = value.split(' ')
    types = [ 'ssh-rsa','ssh-dss','ecdsa-sha2-nistp256',
              'ecdsa-sha2-nistp384','ecdsa-sha2-nistp521','ssh-ed25519' ]
    if value[0] not in types:
        raise ValueError(
          "Expected " + ', '.join(types[:-1]) + ', or ' + types[-1]
        )

    try:
        base64.decodestring(bytes(value[1]))
    except:
        raise ValueError("Expected string of base64 encoded data")

if len(sys.argv) < 1:
    print("Need key to test!")
    exit(1)

try:
    validate_pubkey(sys.argv[1])
except:
    exit(1)
finally:
    exit(0)

